# Year Planner Specification

> **Version:** Extracted from CLAUDE.md (incorporates lessons learned from Year Planner v0.10+)

## 1. Product Overview

The Year Planner is a configurable, printable Microsoft Word document generated by a Python program. The document is designed for duplex printing with a minimal black, white, and gray scale aesthetic.

### 1.1 Design Principles

- Minimal black, white, and gray scale aesthetic optimized for print.
- Strict recto/verso page layout for duplex printing.
- All content expands to fill pages up to margins.
- Table sizes are exactly computable for precise placement.

---

## 2. Configuration Parameters

The Python generator uses a YAML configuration file (`config/config.yaml`) with the following parameters:

| Parameter | Description | Example |
|-----------|-------------|---------|
| `debug` | Enable debug visualization (red borders, blue gutter lines) | `true` |
| `document.title` | Cover page title text | `"Year Planner"` |
| `document.version` | Document version number | `"1.0"` |
| `document.year` | Year for the planner | `2026` |
| `page.width` | Page width in cm (A4) | `21.0` |
| `page.height` | Page height in cm (A4) | `29.7` |
| `page.margin_top` | Top margin in cm | `0.6` |
| `page.margin_bottom` | Bottom margin in cm | `0.6` |
| `page.margin_left` | Left (outside) margin in cm | `0.6` |
| `page.margin_right` | Right (outside) margin in cm | `0.6` |
| `page.gutter_size` | Binding gutter size (mirror margins) | `1.5cm` |
| `page.page_number_position` | Vertical position of page numbers from bottom | `0.75cm` |
| `table.border.thickness` | Border line thickness in points | `0.5` |
| `table.border.grayscale` | Border color (0=white, 100=black) | `50` |
| `table.title_row.height` | Title row height in points | `14.2` |
| `table.title_row.background_grayscale` | Title row background (0=white, 100=black) | `100` |
| `table.title_row.font_size` | Title row font size in points | `10` |
| `table.title_row.font_grayscale` | Title row font color (0=white, 100=black) | `0` |
| `table.header_row.height` | Header row height in points | `14.2` |
| `table.header_row.background_grayscale` | Header row background (0=white, 100=black) | `25` |
| `table.header_row.font_size` | Header row font size in points | `10` |
| `table.header_row.font_grayscale` | Header row font color (0=white, 100=black) | `100` |
| `table.content_row.font_size` | Content row font size in points | `11` |
| `table.content_row.font_grayscale` | Content row font color (0=white, 100=black) | `50` |
| `table.content_row.font_italic` | Whether content row text is italic | `true` |
| `calendar.day_row_height` | Vertical spacing between day rows in points | `15` |
| `calendar.month_name_gap` | Space between month name and days grid in points | `6` |
| `backlog.page_count` | Number of backlog pages | `4` |
| `backlog.row_count` | Number of content rows per backlog table | `16` |
| `graph_paper.page_count` | Number of graph paper pages | `8` |
| `graph_paper.columns` | Number of grid columns | `37` |
| `graph_paper.rows` | Number of grid rows | `56` |
| `graph_paper.grid_color_percent` | Grid line color (0=white, 100=black) | `15` |
| `graph_paper.border_color_percent` | Border color (0=white, 100=black) | `100` |
| `goals.columns` | Number of columns in Goals table | `2` |
| `goals.rows` | Number of content rows in Goals table | `4` |
| `week_planner.rows_per_page` | Content rows per Week Planner table | `14` |
| `daily_spread.rows` | Content rows per Day Table | `8` |
| `daily_spread.subject_width_percent` | Subject column width as percentage | `25` |
| `daily_spread.table_gap` | Vertical space between Day Tables on same page | `0.5cm` |
| `config_info_overlay.bottom` | Distance from bottom edge of page in cm | `1.5` |
| `config_info_overlay.right` | Distance from right edge (recto pages) in cm | `1.5` |
| `config_info_overlay.left` | Distance from left edge (verso pages) in cm | `1.5` |
| `config_info_overlay.width` | Overlay text box width in cm | `6.0` |
| `config_info_overlay.title_font_size` | Overlay title font size in points | `8` |
| `config_info_overlay.data_font_size` | Overlay data font size in points | `6` |
| `toc.rows_per_page` | Content rows per TOC table | `40` |
| `toc.section_grayscale` | Section header row shading (0=white, 100=black) | `15` |
| `toc.first_item_grayscale` | First item marker row shading (0=white, 100=black) | `5` |
| `terms_definitions.page_count` | Number of terms and definitions pages | `4` |
| `terms_definitions.row_count` | Number of content rows per page | `16` |
| `terms_definitions.term_width_percent` | Term column width as percentage | `25` |

---

## 3. Document Structure

### 3.1 Section Order

| # | Section | Logical Page Numbers | Double-Sided | Starts On |
|---|---------|---------------------|--------------|-----------|
| 1 | Cover Page | No | No (inside has contact info) | N/A |
| 2 | Instructions | No | No (single page) | Recto |
| 3 | Calendar | No | No (2 pages: current year + next year, each with blank verso) | Recto |
| 4 | Table of Contents | No | Yes | Recto |
| 5 | Goals | Yes | No (blank verso) | Recto |
| 6 | Backlog | Yes | Yes | Recto |
| 7 | Week Planner | Yes | Yes | Recto |
| 8 | Monthly Sections (×12) | Yes | Yes | Recto |
| 9 | Terms and Definitions | Yes | Yes | Recto | 
| 10 | Graph Paper | Yes | No (blank verso per page) | Recto |
| 11 | Rear Cover | No | No (blank recto + blank verso, reserved) | N/A |

### 3.2 Section Transition Rule

If the last content of a section falls on the recto, the verso is left blank so the next section starts on the recto.

---

## 4. Page Layout

### 4.1 General Layout

```txt
Verso (left, even)                     Recto (right, odd)
┌────────────────────────────────┐  ┌────────────────────────────────┐
│              ↕              ·  │  │  ·              ↕              │
│  ┌────────────────────────┐ ·  │  │  · ┌────────────────────────┐  │
│  │                        │ ·  │  │  · │                        │  │
│ ↔│       CONTENT          │↔·  │  │  ·↔│       CONTENT          │↔ │
│  │                        │ ·  │  │  · │                        │  │
│  └────────────────────────┘ ·  │  │  · └────────────────────────┘  │
│  x            ↕             ·  │  │  ·              ↕            y │
└────────────────────────────────┘  └────────────────────────────────┘
```

- `·` = Binding gutter edge
- `↔` = Left/right margins (can differ: `margin_left`, `margin_right`)
- `↕` = Top/bottom margins (can differ: `margin_top`, `margin_bottom`)
- `x` = Page number (bottom-left, left-aligned) — verso pages only
- `y` = Page number (bottom-right, right-aligned) — recto pages only

### 4.2 Logical Page Numbering

- Starts at `1` on the Goals page (first numbered section).
- Format: Integer only (1, 2, 3, ..., N).
- Recto (odd) pages: Bottom-right, right-aligned.
- Verso (even) pages: Bottom-left, left-aligned.
- **Numbered sections:** Goals, Backlog, Week Planner, Monthly Sections, Terms and Definitions, Graph Paper.
- **Non-numbered sections:** Cover, Instructions, Calendar, Table of Contents, Rear Cover.
- Footer distance from bottom configured via `page.page_number_position`.

---

## 5. Table Styling Standards

All tables in the Year Planner follow a consistent visual style. This section defines the default appearance that should be applied to all new tables.

### 5.1 Fixed Row Height Rule

**Universal Rule:** All rows in all tables use fixed height (`hRule="exact"`). Row height never auto-scales with font size. If the font is increased beyond the row height, text will be clipped.

This rule ensures precise control over table dimensions and page layout.

### 5.2 Row Types

All row type properties are configurable via `config.yaml`:

| Row Type | Background | Text Color | Font Size | Font Weight | Height | Config Section |
|----------|------------|------------|-----------|-------------|--------|----------------|
| Title | Configurable (default: 100% black) | Configurable (default: 0% white) | Configurable (default: 10pt) | Bold | Configurable (default: 14.2pt) | `table.title_row` |
| Header | Configurable (default: 25% gray) | Configurable (default: 100% black) | Configurable (default: 10pt) | Bold | Configurable (default: 14.2pt) | `table.header_row` |
| Content | Per-table logic | Configurable (default: 50% gray, italic) | Configurable (default: 11pt) | Normal | Computed | `table.content_row` |

**Notes:**
- Grayscale values: 0% = white, 100% = black
- Content rows are typically blank (for user input). The `content_row.font_*` settings apply to any supplementary text the generator might add
- Content row background follows per-table logic (e.g., first week of month shading in Week Planner)

### 5.3 Cell Properties

- **Vertical alignment:** Center (all cells)
- **Horizontal alignment:** Left (default), Right (for year/page numbers)
- **Cell margins:** None explicitly set (uses Word defaults)

### 5.4 Table Properties

- **Layout:** Fixed (prevents auto-resizing)
- **Borders:** Configurable thickness and grayscale via `table.border`
- **Column widths:** Specified in twips (dxa) for precision
- **Row height rule:** Exact (prevents font-based expansion)

### 5.5 Page-Filling Tables

Tables that fill the entire page height use computed content row heights:

$$r_c = \frac{p_v - p_{para} - s - r_t - r_h}{n}$$

Where:

| Symbol | Description | Unit |
|--------|-------------|------|
| $r_c$ | Content row height | twips |
| $p_v$ | Available vertical space | twips |
| $p_{para}$ | Preceding paragraph height | 20 twips (minimized page breaks) |
| $s$ | Safety margin | 40 twips (prevents overflow) |
| $r_t$ | Title row height | From `table.title_row.height` (default 284 twips) |
| $r_h$ | Header row height | From `table.header_row.height` (default 284 twips) |
| $n$ | Number of content rows | integer |

### 5.6 Visual Reference

```txt
┌────────────────────────────────────────────────────┐
│ Section Title                              Year    │  ← Title row (configurable bg/text)
├──────────┬─────────────────┬───────────────────────┤
│ Column 1 │ Column 2        │ Column 3              │  ← Header row (configurable bg/text)
├──────────┼─────────────────┼───────────────────────┤
│ Data     │ Data            │                       │  ← Content rows (computed height)
├──────────┼─────────────────┼───────────────────────┤
│ Data     │ Data            │                       │
└──────────┴─────────────────┴───────────────────────┘
```

---

## 6. Section Specifications

### 6.1 Cover Page

**Front (Outside):**

- Document title
- Version number
- Year

**Back (Inside):**

- Contact information table (for lost & found)

---

### 6.2 Instructions Page

Single page displaying a full-page instructions image (`assets/images/instructions.png`) with a transparent title overlay.

**Structure:**

- Full-page image sized to fill the content area
- "Instructions" title (18pt, bold, centered) floats over the image using a DrawingML text box with transparent background
- Starts on the recto
- Blank verso

---

### 6.3 Calendar Page

- Single page showing 12 months in a 3×4 grid (Jan-Feb-Mar in row 1, etc.).
- Starts on the recto.
- Blank verso.
- No logical page number.

---

### 6.4 Table of Contents (TOC)

A custom table-based TOC (not Word's built-in TOC) serving as a hybrid TOC/Index.

**Structure:**

- **Title Row:** "Table of Contents" (repeated on each page)
- **No Header Row**
- **Columns:**
  - Page Label (left-aligned) — describes content, e.g., "Week 1, January 1st, Thursday"
  - User Entry (blank) — for user notes
  - Page Number (right-aligned) — logical page number

**Rules:**

- One row per logical page.
- Days sharing a page get separate rows (e.g., two rows for page 9 if Thu+Fri are on same page).
- Double-sided; tables fill available page space.
- Blank pages represented by blank Page Label cells.
- **Two-level shading:** Section headers (Goals, Backlog, months) use `toc.section_grayscale`. First items (first week of month, first day of week) use `toc.first_item_grayscale`.
- **Dynamic column widths:** Label and page number columns sized to fit content with configurable padding.
- **Day label format:** "Week N, Month ddd, Day" (e.g., "Week 1, January 1st, Thursday")

**Layout (Recto):**

```txt
┌──────────────────────────────────────────────────┐
│ Table of Contents                                │
├────────────────────────────┬────────────────┬────┤
│ Goals                      │                │  1 │  ← Section shading
├────────────────────────────┼────────────────┼────┤
│ Backlog                    │                │  2 │  ← Section shading
├────────────────────────────┼────────────────┼────┤
│ January                    │                │  7 │  ← Section shading
├────────────────────────────┼────────────────┼────┤
│ Week 1, January 1st, Thu   │                │  9 │  ← First item shading
├────────────────────────────┼────────────────┼────┤
│ Week 1, January 2nd, Fri   │                │  9 │
└────────────────────────────┴────────────────┴────┘
```

---

### 6.5 Week Planner

**Structure:**

- **Title Row:** "Week Planner" (repeated on each page)
- **Header Row:** Week | Month | Notes
- **Columns:**
  - Week — ISO 8601 week number (1–52 or 1–53)
  - Month — long form; dual months if week spans two (e.g., "March / April")
  - Notes — blank for user

**Rules:**

- **ISO 8601 week numbering:** Week 1 is the week containing the first Thursday of the year.
- Double-sided; configurable rows per page (default: 16).
- Table fills full page height regardless of row count.
- **First week of month shading:** Rows containing the 1st of any month are shaded light gray (#F2F2F2).
- **Last table optimization:** The final table only includes rows for remaining weeks (no empty rows).
- Generator populates Week and Month columns.

**Layout:**

```txt
┌──────────────────────────────────────────┐
│ Week Planner                        2026 │
├──────┬───────────────┬───────────────────┤
│ Week │ Month         │ Notes             │
├──────┼───────────────┼───────────────────┤
│ 1    │ Dec / January │                   │  ← Shaded (first week of January)
├──────┼───────────────┼───────────────────┤
│ 2    │ January       │                   │
├──────┼───────────────┼───────────────────┤
│ 5    │ Jan / February│                   │  ← Shaded (first week of February)
└──────┴───────────────┴───────────────────┘
```

---

### 6.6 Goals Page

Single page for long-term goals.

**Structure:**

- **Title Row:** "Goals"
- **No Header Row**
- Configurable columns (default: 2)
- Configurable rows (default: 4)

**Rules:**

- Starts on the recto.
- Fills available page space.
- Blank verso.

---

### 6.7 Backlog Section

Multi-page section for unscheduled tasks/ideas.

**Structure:**

- **Title Row:** "Backlog" (repeated on each table)
- **No Header Row**
- Single column (blank cells)
- Configurable rows (default: 16)

**Rules:**

- Configurable page count (default: 4 tables across 2 double-sided pages).
- Double-sided.
- Each table fills full page.

---

### 6.8 Monthly Sections (×12)

Each month contains:

1. **Month Cover Page**
   - Month name centered.
   - Starts on the recto.
   - Blank verso.

2. **Daily Spread**
   - Starts on the recto following month cover.
   - Continues until all days of month are covered.

---

### 6.9 Daily Spread (Day Tables)

**Structure:**

- **Title Row (2 columns):**

  - Column 1: Day name (e.g., "Thursday") — left-aligned
  - Column 2: Date string "Month ddd,  YYYY-MM-DD,  Week N" (e.g., "January 1st,  2026-01-01,  Week 1") — right-aligned
    - Note: Two spaces after each comma for visual separation
- **Header Row:** Subject | Description
- **Columns:**
  - Subject — configurable width percentage (default: 25%)
  - Description — remaining width
- **Rows:** Configurable (default: 8)

**Page Layout:**

- 2 Day Tables per page side (stacked vertically with configurable gap).
- Double-sided (4 Day Tables per physical sheet).
- Days flow continuously (Mon-Tue front, Wed-Thu back, etc.).

**Layout:**

```txt
┌───────────────────┬─────────────────────────────────────┐
│ Thursday          │  January 1st,  2026-01-01,  Week 1  │
├───────────┬───────┴─────────────────────────────────────┤
│ Subject   │ Description                                 │
├───────────┼─────────────────────────────────────────────┤
│           │                                             │
├───────────┼─────────────────────────────────────────────┤
│           │                                             │
└───────────┴─────────────────────────────────────────────┘
┌───────────────────┬─────────────────────────────────────┐
│ Friday            │  January 2nd,  2026-01-02,  Week 1  │
├───────────┬───────┴─────────────────────────────────────┤
│ Subject   │ Description                                 │
├───────────┼─────────────────────────────────────────────┤
│           │                                             │
└───────────┴─────────────────────────────────────────────┘
```

---

### 6.10 Terms and Definitions

Multi-page section to provide users with a place to write down definitions for terms and abbreviations. 

**Structure:**

- **Title Row:** "Terms and Definitions" (repeated on each page)
- **Header Row:** Term / Abbreviation | Definition
- **Columns:**
  - Term / Abbreviation — Blank space for the user to write the term or abbreviation. The column should be 25% the width of the table's total width.
  - Definition — Blank space where the user can write the definition of the term or abbreviation.
- **Rows:**
  - Configurable rows (default: 16)

**Rules:**

- Configurable page count (default: 4 tables across 2 double-sided pages).
- Double-sided.
- Each table fills full page.

**Layout:**

```txt
┌────────────────────────────────────────────────────────────────┐
│ Terms and Definitions                                          │
├─────────────────────┬──────────────────────────────────────────┤
│ Term / Abbreviation │ Definition                               │
├─────────────────────┼──────────────────────────────────────────┤
│                     │                                          │
├─────────────────────┼──────────────────────────────────────────┤
│                     │                                          │
├─────────────────────┼──────────────────────────────────────────┤
│                     │                                          │
└─────────────────────┴──────────────────────────────────────────┘
```

---

### 6.11 Graph Paper Section

**Rules:**

- Configurable page count.
- Grid on the recto only.
- Blank verso (provides both grid and freeform pages).
- Grid line color and border color configurable via grayscale percentage.
- Images generated via Pillow at 300 DPI, cached in `assets/images/`.

---

### 6.12 Rear Cover

**Inside:**

- Calendar for the following year (e.g., 2027 if planner is for 2026).

**Outside:**

- Blank (reserved for future barcode/branding).

---

## 7. Versioning

Files use `vX.Y` milestone-based versioning.

### Version Milestones

| Version | Meaning |
|---------|---------|
| v0.x | Development versions — building out sections incrementally |
| v1.0 | First complete release — all planned sections implemented + final testing passed |
| v1.x | Refinements, bug fixes, and minor enhancements |
| v2.0+ | Major redesign, new features, or significant structural changes |

### Increment Rules

| Change Type | Version Bump | Examples |
|-------------|--------------|----------|
| Bug fix, formatting tweak | v0.3 → v0.4 | Fix row height, adjust spacing |
| New section added (during v0.x) | v0.3 → v0.4 | Add Calendar Page, add TOC |
| All core sections complete + final testing passed | v0.x → v1.0 | First release-ready version |
| Post-release refinements | v1.0 → v1.1 | Polish, minor improvements |
| Major redesign or new features | v1.x → v2.0 | Structural overhaul, new section types |

**Synchronized versioning** applies to:

- Configuration file (`config/config.yaml`)
- Python generator (`src/`)
- Output Word document (`output/`)

**Backup policy:** Create `.bak` copies in `backup/` before any change, even without version increment.

---

## 8. Appendix: ASCII Art Reference

See individual section specifications above for detailed ASCII layouts of each table type.
